const e={playerHeader:"",playerContainer:"w-full mx-auto max-w-7xl",bibleListContainer:"",chapterListContainer:"relative w-full max-w-4xl mx-auto",bibleListGrid:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",bibleBlockInfoWrap:"flex flex-row justify-between gap-4 max-w-md w-full mx-auto bg-stone-100 border border-stone-200 mt-12 p-3",bibleBlock:"flex flex-col justify-between text-sm text-center md:text-base lg:text-lg font-semibold text-black",bibleBlockTitleGroup:"flex-shrink truncate",bibleBlockVernacular:"truncate text-sm mb-1",bibleBlockTitle:"truncate text-2xl font-semibold",bibleBlockLanguageGroup:"",bibleBlockIso:"text-sm",bibleBlockButtonGroup:"flex flex-col justify-between",container:"audio-player-container mx-auto max-w-7xl w-full",audio:"",controlsContainer:"controls-container flex flex-col",navRow:"flex flex-row items-center justify-center gap-4 py-4 bg-stone-100 border border-stone-200 w-full max-w-md mx-auto",prevBookButton:"prev-book-button flex justify-center items-center",prevChapterButton:"prev-chapter-button flex justify-center items-center",playPauseButton:"play-pause-button flex justify-center items-center",playPauseIcon:"icon-play",nextChapterButton:"next-chapter-button flex justify-center items-center",nextBookButton:"next-book-button flex justify-center items-center",controlRow2:"grid grid-cols-5 mb-1",leftControls:"flex flex-row justify-center items-center col-span-2 space-x-6",playbackRate:{wrapper:"flex mx-auto w-full max-w-md justify-center px-8 py-2 bg-stone-100 text-xs",display:"mx-1 text-stone-400 text-sm",increase:"w-6 h-6 border-2 rounded-2xl text-stone-500",decrease:"w-6 h-6 border-2 rounded-2xl text-stone-500",disabled:"opacity-50"},rightControls:"flex flex-row justify-center items-center col-span-2 space-x-6",playSpeedControl:"flex flex-row justify-center items-center text-xs",decreaseSpeedButton:"w-6 h-6 border-2 rounded-2xl hover:border-blue-600 dark:hover:border-white text-stone-500 dark:hover:text-white",increaseSpeedButton:"w-6 h-6 border-2 rounded-2xl hover:border-blue-600 dark:hover:border-white text-stone-500 dark:hover:text-white",skipBackButton:"skip-backward-button flex justify-center items-center text-stone-400 hover:text-blue-600 dark:text-white dark:hover:text-blue-400",skipForwardButton:"skip-forward-button flex justify-center items-center text-stone-400 hover:text-blue-600 dark:text-white dark:hover:text-blue-400",progress:{container:"flex mx-auto w-full max-w-md justify-around px-1 pt-4 bg-stone-100 text-xs",wrapper:"mx-auto min-w-80 mx-3 w-3/4 sm:w-5/6 h-3 rounded-lg relative border bg-gradient-to-br shadow-inner border-stone-300 from-white to-stone-200 dark:from-neutral-50 dark:to-stone-400 border-stone-500",barInner:"h-3 w-0 bg-blue-600 rounded-md",circleTip:"absolute top-1/2 transform -translate-y-1/2 -translate-x-1/2 w-5 h-5 bg-blue-600 rounded-full border border-blue-500",currentTimeDisplay:"text-black",durationDisplay:"text-black",tick:"w-[3px] absolute top-0 h-full bg-stone-400"},mediaPlayerWrap:"w-full flex flex-col justify-center",mediaPlayerHeader:"",mediaPlayerBody:"",mediaPlayerNavRow:"grid grid-cols-5 px-2 text-stone-700 dark:text-stone-300 divide-x divide-stone-500 dark:divide-stone-600",bibleListNavButton:"",bookListNavButton:"",chapterListNavButton:"",volumeRow:"flex flex-row justify-center items-center max-w-md bg-stone-100 border border-stone-200 mx-auto",volumeControl:"volume-control w-full",volumeInput:"w-full",volumeLabel:"flex flex-row pl-2 mx-4 w-1/2",selectBookChapterWrap:"relative bg-stone-100 flex flex-row gap-2 w-full max-w-md mx-auto",selectBook:"inline-flex items-center gap-x-1.5 bg-stone-100 hover:bg-stone-200 px-3 py-2 w-full",selectChapter:"inline-flex items-center text-center bg-stone-100 w-12 hover:bg-stone-200 border-none appearance-none",selectVerseSeparator:"inline-flex items-center bg-stone-100",selectVerse:"inline-flex items-center text-center bg-stone-100 w-12 hover:bg-stone-200 border-none appearance-none",bibleButton:{wrapper:"flex flex-row bg-stone-100 border border-stone-200 rounded min-h-20 hover:bg-stone-200",languageWrap:"py-1 bg-stone-200 h-full w-24 flex flex-col justify-center items-center",language:"text-sm font-medium text-stone-900",iso:"truncate font-mono mt-1 text-sm text-stone-500",titleWrap:"py-1 h-full w-full flex flex-col justify-center items-center",title:"line-clamp-2 text-center text-sm font-medium text-stone-900",vernacular:"line-clamp-1 text-sm text-stone-500"},sleepTimerButton:"sleep-timer-button group block py-1.5 px-1",sleepTimerDuration:"text-xs pl-1 pt-2 inline-block timer-display",sleepTimerWrap:"flex flex-row justify-center align-start text-stone-400 hover:text-blue-600",searchWrapper:"mx-auto flex items-center w-1/3 my-3",searchInput:"px-4 py-2 w-full max-w-7xl mx-auto bg-white border border-stone-200",searchInputContainer:"flex w-full max-w-xl mx-auto my-4",bookListContainer:"w-full",bookListGrid:"grid grid-cols-3 md:grid-cols-4 gap-2",bookListButton:"bg-stone-100 border rounded md:rounded-lg",bookListButtonActive:"bg-stone-100 border border-stone-300",bookListTitle:"font-medium text-sm lg:text-base",bookListId:"w-full flex justify-end opacity-60 text-sm mr-8",chapterButton:"bg-stone-100/90 w-12 h-12 m-2 border border-stone-700 rounded text-lg hover:bg-stone-300",chapterButtonActive:"bg-stone-500 text-stone-100"},t={sleepTimer:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-7 h-7"><path d="M22.97 16.84h-3.25l3.56-3.26c.07-.05.1-.08.1-.14a.43.4 0 0 0-.37-.56h-4.38a.45.41 0 0 0 0 .82h3.29l-3.6 3.25a.43.4 0 0 0-.09.43.43.4 0 0 0 .4.25h4.34a.43.4 0 0 0 0-.79zm-6.44 1.98h-2.45l2.79-2.49a.43.4 0 0 0 .06-.45.43.4 0 0 0-.4-.26h-3.48a.45.41 0 0 0 0 .82h2.48l-2.79 2.5-.06.14a.31.28 0 0 0 0 .28.43.4 0 0 0 .37.28h3.5a.45.41 0 0 0 0-.82zm2.75 3.9h-1.42l1.73-1.55.1-.14v-.28a.43.4 0 0 0-.44-.29h-2.48a.43.4 0 0 0 0 .8h1.43l-1.74 1.55a.43.4 0 0 0-.09.46.43.4 0 0 0 .4.22h2.48a.43.4 0 0 0 0-.79z" style="stroke-width:.296239"/></svg>',chapters:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125M3.375 19.5h7.5c.621 0 1.125-.504 1.125-1.125m-9.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-7.5A1.125 1.125 0 0 1 12 18.375m9.75-12.75c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125m19.5 0v1.5c0 .621-.504 1.125-1.125 1.125M2.25 5.625v1.5c0 .621.504 1.125 1.125 1.125m0 0h17.25m-17.25 0h7.5c.621 0 1.125.504 1.125 1.125M3.375 8.25c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m17.25-3.75h-7.5c-.621 0-1.125.504-1.125 1.125m8.625-1.125c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M12 10.875v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125M13.125 12h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125M20.625 12c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5M12 14.625v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 14.625c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m0 1.5v-1.5m0 0c0-.621.504-1.125 1.125-1.125m0 0h7.5" /></svg>',bibles:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 0 1-.825-.242m9.345-8.334a2.126 2.126 0 0 0-.476-.095 48.64 48.64 0 0 0-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0 0 11.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155" /></svg>',books:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z" /></svg>',PrevBook:'<svg xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="w-7 h-7 hover:text-blue-600 dark:hover:text-blue-300" viewBox="0 0 23 13"><g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-width="1.5"><path stroke-linejoin="round" d="M22 2.7c0-.9-1-1.4-1.7-1l-7 4a1.1 1.1 0 0 0 0 2l7 4a1.1 1.1 0 0 0 1.7-.9V2.7h0Zm-9.7 0c0-.9-1-1.4-1.7-1l-7.1 4a1.1 1.1 0 0 0 0 2l7 4a1.1 1.1 0 0 0 1.8-.9V2.7h0Z"/><path d="M1.5 1v11"/></g></svg>',PrevChapter:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1.5" class="w-7 h-7 hover:text-blue-600 dark:hover:text-blue-300" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21 16.8c0 .9-1 1.4-1.7 1l-7-4a1.1 1.1 0 0 1 0-2l7-4a1.1 1.1 0 0 1 1.7.9v8.1zm-9.8 0c0 .9-.9 1.4-1.6 1l-7.1-4a1.1 1.1 0 0 1 0-2l7-4a1.1 1.1 0 0 1 1.8.9v8.1z"/></svg>',nextChapter:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1.5" class="w-7 h-7 hover:text-blue-600 dark:hover:text-blue-300" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M3 8.7c0-.9 1-1.4 1.7-1l7 4a1.1 1.1 0 0 1 0 2l-7 4a1.1 1.1 0 0 1-1.7-.9V8.7zm9.8 0c0-.9.9-1.4 1.6-1l7.1 4a1.1 1.1 0 0 1 0 2l-7 4a1.1 1.1 0 0 1-1.8-.9V8.7z"/></svg>',nextBook:'<svg xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="w-7 h-7 hover:text-blue-600 dark:hover:text-blue-300" viewBox="0 0 23 13"><g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-width="1.5"><path stroke-linejoin="round" d="M1 2.7c0-.9 1-1.4 1.7-1l7 4a1.1 1.1 0 0 1 0 2l-7 4a1.1 1.1 0 0 1-1.7-.9V2.7h0Zm9.7 0c0-.9 1-1.4 1.7-1l7.1 4a1.1 1.1 0 0 1 0 2l-7 4a1.1 1.1 0 0 1-1.8-.9V2.7h0Z"/><path d="M21.5 1v11"/></g></svg>',play:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1.5" class="w-10 h-10 hover:text-blue-400" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5.3 5.7c0-.9.9-1.4 1.6-1L18.5 11a1.1 1.1 0 0 1 0 2L6.9 19.3a1.1 1.1 0 0 1-1.6-1V5.7z"/></svg>',pause:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1.5" class="w-10 h-10 hover:text-blue-600 dark:hover:text-blue-300" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.8 5.3v13.4M8.2 5.3v13.4"/></svg>',volumeIcon:'<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="size-5" viewBox="0 0 20 20"><path d="M11 4a1 1 0 0 0-2-1L5 7H3a1 1 0 0 0-1 0 7 7 0 0 0 0 3v3h3l4 4a1 1 0 0 0 2-1V4Zm5 1a1 1 0 0 0-1 1 6 6 0 0 1 0 8 1 1 0 0 0 1 1 7 7 0 0 0 0-10Z"/><path d="M14 7a1 1 0 0 0-1 1 3 3 0 0 1 0 4 1 1 0 0 0 1 1 4 4 0 0 0 0-6Z"/></svg>',skipBackward:'<svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7" stroke="currentColor" viewBox="0 0 24 24"><path d="M16 1a2 2 0 0 0-1.4.6l-3 3a2 2 0 0 0 0 2.8l3 3a2 2 0 1 0 2.8-2.8L15.8 6l1.6-1.6A2 2 0 0 0 16 1zm8 0a2 2 0 0 0-1.4.6l-3 3a2 2 0 0 0 0 2.8l3 3a2 2 0 0 0 3.2-2.3A16 16 0 0 1 24 40 16 16 0 0 1 8 24a2 2 0 1 0-4 0A20 20 0 1 0 25.7 4 2 2 0 0 0 24 1zm.8 16c-.7 0-1.3.5-1.4 1.2l-.9 4.5a1.5 1.5 0 0 0 1.5 1.8h3.3c1 0 1.7.8 1.7 1.8 0 1.4-1 1.7-2 1.7-1.6 0-2.5-.6-2.6-.7a1.5 1.5 0 0 0-1.8 2.4c.1.1 1.7 1.3 4.4 1.3 3 0 5-2 5-4.8 0-2.6-2.1-4.7-4.8-4.7h-1.4l.3-1.5H30a1.5 1.5 0 1 0 0-3h-5.2zm-6.4 0H18l-3 1a1.5 1.5 0 0 0 1 3l1-.4v8.9a1.5 1.5 0 1 0 3 0v-11a1.5 1.5 0 0 0-1.6-1.5z" style="stroke:none;stroke-width:1;stroke-dasharray:none;stroke-linecap:butt;stroke-dashoffset:0;stroke-linejoin:miter;stroke-miterlimit:4;fill-rule:nonzero;opacity:1" transform="matrix(.5 0 0 .5 1 1.7)"/></svg>',skipForward:'<svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7" stroke="currentColor" viewBox="0 0 24 24"><path d="M24 .5A1.5 1.5 0 0 0 23 3l1 1a20 20 0 1 0 21 19.4 1.5 1.5 0 1 0-3 0A17 17 0 1 1 23.8 7.2l-.9.8a1.5 1.5 0 1 0 2.2 2.2l3.5-3.5c.5-.6.5-1.6 0-2.2L25 1c-.3-.3-.7-.4-1.1-.4zm7 0A1.5 1.5 0 0 0 30 3l2.4 2.4-2.5 2.4a1.5 1.5 0 1 0 2.2 2.2l3.5-3.5c.5-.6.5-1.6 0-2.2L32 1c-.3-.3-.7-.4-1.1-.4zM19.6 17h-.3l-3 1a1.3 1.3 0 0 0 .8 2.4l1.4-.4v9.8a1.3 1.3 0 1 0 2.5 0V18.1a1.2 1.2 0 0 0-1.4-1.2zm6.1 0c-.6 0-1.1.4-1.2 1l-.8 4.8a1.3 1.3 0 0 0 1.2 1.5h3.5a2 2 0 0 1 2 2c0 .8-.1 1.2-.5 1.6a3 3 0 0 1-1.8.5c-1.7 0-3-.8-3-.8a1.3 1.3 0 1 0-1.5 2c.5.3 2 1.3 4.5 1.3a5 5 0 0 0 3.5-1.2 4.6 4.6 0 0 0-3.2-8h-2l.4-2.2h4.5a1.3 1.3 0 1 0 0-2.5h-5.6z" style="stroke:none;stroke-width:1;stroke-dasharray:none;stroke-linecap:butt;stroke-dashoffset:0;stroke-linejoin:miter;stroke-miterlimit:4;fill-rule:nonzero" transform="matrix(.5 0 0 .5 .5 1.8)"/></svg>'},o={},a="https://content.dbs.org";async function s(e,t){e.query="";const o=await async function(e){const t={"01":"GEN","02":"EXO","03":"LEV","04":"NUM","05":"DEU","06":"JOS","07":"JDG","08":"RUT","09":"1SA",10:"2SA",11:"1KI",12:"2KI",13:"1CH",14:"2CH",15:"EZR",16:"NEH",17:"EST",18:"JOB",19:"PSA",20:"PRO",21:"ECC",22:"SNG",23:"ISA",24:"JER",25:"LAM",26:"EZK",27:"DAN",28:"HOS",29:"JOL",30:"AMO",31:"OBA",32:"JON",33:"MIC",34:"NAM",35:"HAB",36:"ZEP",37:"HAG",38:"ZEC",39:"MAL",40:"MAT",41:"MRK",42:"LUK",43:"JHN",44:"ACT",45:"ROM",46:"1CO",47:"2CO",48:"GAL",49:"EPH",50:"PHP",51:"COL",52:"1TH",53:"2TH",54:"1TI",55:"2TI",56:"TIT",57:"PHM",58:"HEB",59:"JAS",60:"1PE",61:"2PE",62:"1JN",63:"2JN",64:"3JN",65:"JUD",66:"REV"},o=await fetch(`${a}/bibles/audio-new/${e}/index.txt`),s=await o.text(),n=new Map,r=/^\.\/\w+\/(\d+)_(\w+)_(\d+)\.mp3$/;s.split("\n").sort().forEach((e=>{const o=e.match(r);if(o){const[,e,a,s]=o,r=parseInt(s,10),i=t[e];n.has(i)||n.set(i,{name:a,book_number:e,book_id:i,chapters:[]}),n.get(i).chapters.push(r)}}));let i=[];try{const t=await fetch(`${a}/bibles/audio-new/${e}/timingfiles/_index.txt`);t.ok?i=(await t.text()).split("\n"):console.warn("Timing files not found or inaccessible.")}catch(e){console.warn("Failed to fetch timing files:",e.message)}for(const e of n.values())e.chapters.sort(((e,t)=>e-t));return{bible_id:e.split("_")[0],bible_folder:e,timestamps:i,data:Array.from(n.values())}}(t);e.currentBooks=o;const s=e.bibles.find((t=>t.abbr===e.currentBooks.bible_id));e.currentBible=s;new URL(window.location).searchParams.set("id",e.currentBible.id),await async function(e,t,o){e.currentBook=t,await n(e,t,o)}(e,o.data[0],1)}async function n(e,t,o){e.currentBook=t;let a=o;if(t?.chapters?.includes(o)||(a=1),"hark"===e.currentType){const o="19"===t.book_number?3:2;e.currentChapter={path:`https://content.dbs.org/bibles/audio-new/${e.currentBooks.bible_folder}/${t.book_number}_${t.name}_${a.toString().padStart(o,"0")}.mp3`,title:`${t.name} ${a}`,number:a,book_id:t.book_id,timestamps:[]},e.audio.src=e.currentChapter.path;const s=new URL(window.location);if(s.searchParams.set("book",t.book_id),s.searchParams.set("c",a),e.currentBooks.timestamps){const t=/Verse (\d+)	(\d+:\d+:\d+\.\d+)/gm;let o,s=await fetch(`https://content.dbs.org/bibles/audio-new/${e.currentBooks.bible_folder}/timingfiles/${e.currentBook.book_id}_${a.toString().padStart(3,"0")}.txt`).then((function(e){return e.text()})).catch((e=>{console.error("Error:",e)})),n=[];for(;null!==(o=t.exec(s));){o[1];const e=o[2];n.push(e)}e.currentChapter.timestamps=n}}}function r(e,t={}){const o=document.createElement(e);for(const[e,a]of Object.entries(t))"style"===e&&"object"==typeof a?Object.assign(o.style,a):o[e]=a;return o}function i(e){const t=e%60|0;return`${e/60|0}:${t<10?"0":""}${t}`}const l=e=>{const[t,o,a]=e.split(":");return 3600*parseInt(t,10)+60*parseInt(o,10)+parseFloat(a)};function c(e){e.chapterListContainer.innerHTML="",e.bibleListContainer.style.display="none",e.bookListContainer.style.display="none",e.chapterListContainer.style.display="block";const t=document.createDocumentFragment();if(e.currentBook.chapters.forEach((o=>{const a=r("button",{className:`${e.class.chapterButton} ${e.currentChapter.number==o?" "+e.class.chapterButtonActive:""}`,ariaLabel:`Play Chapter ${o}`,textContent:o,onclick:()=>d(e,e.currentBook,o)});t.appendChild(a)})),e.chapterListContainer.appendChild(t),e.currentBook?.book_id){const t=e.art[e.currentBook.book_id]?.[0];if(!t)return void console.warn(`No art found for book ID: ${e.currentBook.book_id}`);const o=document.createElement("img");o.src=`./img/chars/${t.file}`,o.className=t.class,e.chapterListContainer.appendChild(o)}}function d(e,t,o){n(e,t,o),e.chapterSelect.value=o,e.audio.play();document.querySelector(".icon-play").innerHTML=e.audio.paused?e.icons.play:e.icons.pause,c(e)}function u(e,t,o){const a=e.toLowerCase(),s=Math.max(.5,.9-(a.length>10?.15:.05*a.length));return t.reduce(((e,t)=>{let n=0,r=0;return o.forEach((e=>{if(t[e]){const o=t[e].toString().toLowerCase(),i=function(e,t){if(e===t)return 0;const o=Array.from({length:e.length+1},((e,t)=>t));for(let a=1;a<=t.length;a++){let s=o[0];o[0]=a;for(let n=1;n<=e.length;n++){const r=o[n];o[n]=Math.min(o[n]+1,o[n-1]+1,s+(e[n-1]!==t[a-1])),s=r}}return o[e.length]}(a,o)/Math.max(a.length,o.length);i<=s&&(n+=i,r++)}})),r>0&&e.push({item:t,score:n/r}),e}),[]).sort(((e,t)=>e.score-t.score))}function p(e){e.bibleListContainer.innerHTML="";const t=r("div",{className:e.class.searchWrapper}),o=r("input",{type:"search",placeholder:"Filter Audio Bibles",autocomplete:"off",className:e.class.searchInput,oninput:()=>{e.query=o.value,e.results=u(e.query,e.bibles,["tt","tv","ln"]),b(e)}});o.setAttribute("aria-label","Search"),t.appendChild(o),e.bibleListContainer.appendChild(t);const a=r("div",{className:e.class.bibleListGrid});e.bibleListGrid=a,e.bibleListContainer.appendChild(a),b(e)}function b(e){const t=e.bibleListGrid;t.innerHTML="";const o=e.query?e.results.map((e=>e.item)):e.bibles,a=document.createDocumentFragment();o.forEach((t=>a.appendChild(function(e,t){const o=r("button",{className:e.class.bibleButton.wrapper,onclick:()=>h(e,t)});o.dataset.testId=t.id,o.setAttribute("aria-label",t.tv??t.tt);const a=r("div",{className:e.class.bibleButton.languageWrap});a.appendChild(r("h2",{className:e.class.bibleButton.language,textContent:t.ln})),a.appendChild(r("small",{className:e.class.bibleButton.iso,textContent:t.iso}));const s=r("div",{className:e.class.bibleButton.titleWrap});if(s.appendChild(r("h4",{className:e.class.bibleButton.title,textContent:t.tt})),t.tt!==t.tv&&t.tv){const o=r("p",{className:e.class.bibleButton.vernacular,textContent:t.tv});s.appendChild(o)}return o.appendChild(a),o.appendChild(s),o}(e,t)))),t.appendChild(a)}async function h(e,t){if("hark"===t.tp){e.view="book",e.currentBible=t,await s(e,t.id),m(e,t),e.render();const o=new URL(window.location);o.searchParams.set("bibleId",t.id),window.history.replaceState({},"",o)}else t.tp}function m(e,t){e.bibleBlock.innerHTML="",e.bibleBlock.className=e.class.bibleBlock;const o=r("div",{className:e.class.bibleBlockInfoWrap}),a=r("div",{className:e.class.bibleBlockLanguageGroup});a.appendChild(r("div",{className:e.class.bibleBlockIso,innerText:t.iso})),a.appendChild(r("div",{innerText:t.cn})),o.append(a);const s=r("div",{className:e.class.bibleBlockTitleGroup});s.appendChild(r("div",{className:e.class.bibleBlockTitle,innerText:t.tt})),t.tv&&t.tv!==t.tt&&s.appendChild(r("div",{className:e.class.bibleBlockVernacular,innerText:t.tv})),o.appendChild(s);const n=r("div",{className:e.class.selectBookChapterWrap}),i=r("select",{className:e.class.selectBook});e.currentBooks&&e.currentBooks.data&&e.currentBooks.data.forEach((t=>{const o=r("option",{value:t.book_id,innerText:t.name,selected:t.book_id===e.currentBook.book_id});i.appendChild(o)})),i.addEventListener("change",(t=>{k(e,t.target.value)}));const u=r("select",{className:e.class.selectChapter});if(e.currentBook&&e.currentBook.chapters&&e.currentBook.chapters.forEach((t=>{const o=r("option",{value:t,innerText:t,selected:t==e.currentChapter.number});u.appendChild(o)})),u.addEventListener("change",(t=>d(e,e.currentBook,parseInt(t.target.value)))),n.appendChild(i),n.appendChild(u),e.currentChapter&&e.currentChapter.timestamps&&Array.isArray(e.currentChapter.timestamps)){const t=r("select",{className:e.class.selectVerse});e.currentChapter.timestamps.forEach(((e,o)=>{const a=o+1,s=r("option",{value:a,innerText:`${a}`});t.appendChild(s)})),t.addEventListener("change",(t=>{const o=parseInt(t.target.value)-1;if(e.currentChapter.timestamps&&e.currentChapter.timestamps[o]){const t=e.currentChapter.timestamps[o],a=l(t);e.audio.currentTime=a}}));const o=r("div",{innerText:":",className:e.class.selectVerseSeparator});n.appendChild(o),n.appendChild(t),e.verseSelect=t}if(e.verseSelect){let t=null;e.audio.addEventListener("timeupdate",(()=>{const o=e.audio.currentTime,a=e.currentChapter.timestamps;let s=-1;for(let e=0;e<a.length&&o>=l(a[e]);e++)s=e;-1!==s&&s!==t&&(t=s,e.verseSelect.value=s+1)}))}e.bookSelect=i,e.chapterSelect=u;const p=r("div",{className:e.class.bibleBlockButtonGroup});p.appendChild(r("button",{innerHTML:e.icons.bibles,className:e.class.bibleListNavButton,onclick:()=>{e.view="bible",e.render()}})),"chapter"===e.view&&p.appendChild(r("button",{innerHTML:e.icons.books,className:e.class.bookListNavButton,onclick:()=>{e.view="book",x(e),e.render()}})),"book"===e.view&&p.appendChild(r("button",{innerHTML:e.icons.chapters,className:e.class.chapterListNavButton,onclick:()=>{e.view="chapter",c(e),e.render()}})),o.append(p),e.bibleBlock.append(o),e.bibleBlock.appendChild(n),x(e)}function k(e,t,o=1){const a=e.currentBooks.data.find((e=>e.book_id===t));if(!a)return;n(a,o);const s=new URL(window.location);s.searchParams.set("bookId",a.book_id),window.history.replaceState({},"",s),e.query="",e.chapterListContainer.style.display="block",e.view="chapter",e.currentBook=a,c(e),m(e,e.currentBible)}function v(e,t){const o=r("button",{className:`${t.book_id} ${e.class.bookListButton} ${e.currentBook.book_id==t.book_id?e.class.bookListButtonActive:""}`,ariaLabel:t.name,onclick:()=>k(e,t.book_id)});o.dataset.bookId=t.book_id;const a=r("div");return a.append(r("h2",{className:e.class.bookListTitle,textContent:t.name}),r("h3",{className:e.class.bookListId,textContent:t.book_id})),o.appendChild(a),o}function x(e){const t=e.bookListGrid;t.innerHTML="",e.resultsBooks&&e.resultsBooks.length&&""!==e.query?e.resultsBooks.forEach((o=>{t.appendChild(v(e,o.item))})):e.currentBooks&&""===e.query&&e.currentBooks.data&&e.currentBooks.data.forEach((o=>{t.appendChild(v(e,o))}))}function f(e){const t=document.createDocumentFragment(),o=r("div",{className:e.class.controlsContainer}),a=r("div",{className:e.class.navRow}),s=r("button",{className:e.class.prevBookButton,innerHTML:e.icons.PrevBook,onclick:()=>{const t=e.currentBooks.data.findIndex((t=>t.book_id===e.currentBook.book_id));e.currentBooks.data[t-1]&&(k(e,e.currentBooks.data[t-1].book_id),d(e,e.currentBooks.data[t-1],1))}}),n=r("button",{className:e.class.prevChapterButton,innerHTML:e.icons.PrevChapter,onclick:()=>async function(e){if(e.currentChapter.number-1>1)d(e,e.currentBook,e.currentChapter.number-1);else{const t=e.currentBooks.data.findIndex((t=>t.book_id===e.currentBook.book_id));e.currentBooks.data[t-1]&&(k(e,e.currentBooks.data[t-1].book_id),d(e,e.currentBooks.data[t-1],1))}}(e)}),c=w(e,"back"),u=r("span",{className:e.class.playPauseIcon,innerHTML:e.icons.play}),p=r("button",{className:e.class.playPauseButton,onclick:()=>e.audio.paused?e.audio.play():e.audio.pause()});p.appendChild(u),e.audio.addEventListener("play",(()=>{u.innerHTML=e.icons.pause})),e.audio.addEventListener("pause",(()=>{u.innerHTML=e.icons.play}));const b=w(e,"forward"),h=r("button",{className:e.class.nextChapterButton,innerHTML:e.icons.nextChapter,onclick:()=>async function(e){if(e.currentChapter.number<e.currentBook.chapters.length-1)d(e,e.currentBook,e.currentChapter.number+1);else{const t=e.currentBooks.data.findIndex((t=>t.book_id===e.currentBook.book_id));e.currentBooks.data[t+1]&&(k(e,e.currentBooks.data[t+1].book_id),d(e,e.currentBooks.data[t+1],1))}}(e)}),m=r("button",{className:e.class.nextBookButton,innerHTML:e.icons.nextBook,onclick:()=>{const t=e.currentBooks.data.findIndex((t=>t.book_id===e.currentBook.book_id));e.currentBooks.data[t+1]&&(k(e,e.currentBooks.data[t+1].book_id),d(e,e.currentBooks.data[t+1],1))}});a.append(s,n,c,p,b,h,m),o.append(a),o.append(function(e){function t(e,t,o){const a=o.getBoundingClientRect(),s=(e.clientX-a.left)/a.width;t.audio.currentTime=Math.max(0,Math.min(s,1))*t.audio.duration}const o=r("div",{className:e.class?.progress?.container}),a=r("div",{id:"currentTime",className:e.class?.progress?.currentTimeDisplay,textContent:i(e.audio.currentTime)}),s=r("div",{id:"progress-wrapper",className:e.class?.progress?.wrapper}),n=r("div",{id:"progress-bar",className:e.class?.progress?.barInner,style:{width:"0%"}}),c=r("div",{id:"timestamps-wrapper",className:e.class?.progress?.timestamps}),d=r("div",{className:e.class?.progress?.circleTip,style:{left:"0%"}});s.append(n,d);const u=o=>{e.isDragging&&t(o,e,s)},p=()=>{e.isDragging&&(e.isDragging=!1,document.body.style.userSelect="",document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",p))};s.addEventListener("mousedown",(()=>{e.isDragging=!0,document.body.style.userSelect="none",document.addEventListener("mousemove",u),document.addEventListener("mouseup",p)})),s.addEventListener("click",(o=>{t(o,e,s)}));const b=r("div",{className:e.class?.progress?.durationDisplay,textContent:i(e.audio.duration||0)});return e.audio.addEventListener("timeupdate",(()=>{const t=e.audio.currentTime/e.audio.duration*100;n.style.width=`${t}%`,d.style.left=`calc(${t}% - 3px)`,a.textContent=i(e.audio.currentTime)})),e.audio.addEventListener("loadedmetadata",(()=>{c.innerHTML="",b.textContent=i(e.audio.duration),e.currentChapter.timestamps&&Array.isArray(e.currentChapter.timestamps)&&e.currentChapter.timestamps.forEach((t=>{const o=l(t);if(o<=e.audio.duration&&o>=0){const t=o/e.audio.duration*100,a=r("div",{className:`progress-tick ${e?.class?.progress?.tick}`,style:{left:`${t}%`}});c.appendChild(a)}}))})),s.append(c),o.append(a,s,b),o}(e));const{volumeRow:v,sleepTimerButton:x}=function(e){const t=r("div",{className:e.class.volumeRow}),o=r("input",{type:"range",min:"0",max:"1",step:"0.01",className:e.class.volumeInput,id:"volume-control",value:e.audio.volume});o.addEventListener("input",(()=>{e.audio.volume=parseFloat(o.value)}));const a=r("label",{htmlFor:"volume-control",className:e.class.volumeLabel,innerHTML:e.icons.volumeIcon});a.appendChild(o),t.appendChild(a);const s=r("button",{className:e.class.sleepTimerButton,innerHTML:e.icons.sleepTimer});let n=null,l=0;const c=6e4,d=r("span",{className:e.class.sleepTimerDuration,textContent:i(60)});function u(e){const t=l/c,o=2*Math.PI*9;d.textContent=i(e/1e3);const a=s.querySelector("svg circle:nth-child(2)");a&&a.setAttribute("stroke-dashoffset",(1-t)*o)}return s.appendChild(d),s.addEventListener("click",(()=>{n?(clearInterval(n),n=null,o.value=1,e.audio.volume=1,l=0,u(c)):(l=0,n=setInterval((()=>{l+=1e3;const t=c-l,a=t/c;o.value=Math.max(0,a),e.audio.volume=parseFloat(o.value),u(t),l>=c&&(clearInterval(n),n=null,e.audio.pause(),u(0))}),1e3))})),{volumeRow:t,sleepTimerButton:s}}(e);return o.append(function(e){const t=e.options?.playbackRate?.min??.5,o=e.options?.playbackRate?.max??2.25,a=e.options?.playbackRate?.step??.25,s=(t,o)=>{t.className=`${t.baseClassName} ${o?e.class.playbackRate?.disabled:""}`},n=a=>{e.audio.playbackRate=Math.min(o,Math.max(t,e.audio.playbackRate+a)),c.textContent=e.audio.playbackRate.toFixed(2),s(l,e.audio.playbackRate===t),s(d,e.audio.playbackRate===o)},i=r("div",{className:e.class.playbackRate?.wrapper}),l=r("button",{baseClassName:e.class.playbackRate?.decrease,className:e.class.playbackRate?.decrease,textContent:"-",onclick:()=>n(-a)}),c=r("span",{className:e.class.playbackRate?.display,textContent:e.audio.playbackRate.toFixed(2)}),d=r("button",{baseClassName:e.class.playbackRate?.increase,className:e.class.playbackRate?.increase,textContent:"+",onclick:()=>n(a)});return i.append(l,c,d),i}(e)),o.appendChild(v),v.appendChild(x),v.appendChild(x),t.appendChild(v),t.appendChild(o),t}function w(e,t){const o="forward"===t,a=o?e.icons.skipForward:e.icons.skipBackward,s=o?15:-15;return r("button",{className:o?e.class.skipForwardButton:e.class.skipBackButton,innerHTML:a,onclick:()=>{e.audio.currentTime+=s,e.audio.currentTime<0&&(e.audio.currentTime=0),e.audio.currentTime>e.audio.duration&&(e.audio.currentTime=e.audio.duration)}})}class y{constructor(a,s){this.container=document.getElementById(a),this.bookListGrid=null,this.mediaPlayerWrap=null,this.providers=s.providers??["hark"],this.bibles=[],this.engineBibles=null,this.currentBible=null,this.currentBooks=[],this.currentBook=null,this.currentChapter={number:0},this.audio=document.createElement("audio"),this.currentType="hark",this.isDragging=!1,this.class=((t={})=>{const o={...e};for(const e of Object.keys(t))e.startsWith("_")?o[e.substring(1)]=t[e]:o[e]=t[e];return o})(s.classes),this.icons=((e={})=>{const o={...t};for(const t of Object.keys(e))o[t]=e[t];return o})(s.icons),this.art=((e={})=>{const t={...o};for(const o of Object.keys(e))t[o]=e[o];return t})(s.art),this.results=[],this.query="",this.engineBooks=null,this.view="bible",this.idPrefix=s?.idPrefix??"audio-player",this.bookSelect=null,this.chapterSelect=null}static async create(e,t){const o=new y(e,t);o.providers.includes("hark")&&(o.bibles=o.bibles.concat(await async function(e="all",t="all"){const o=await fetch("https://arc.dbs.org/api/bibles").then((e=>e.json()));let s=await fetch(`${a}/bibles/audio-new/index.txt`).then((e=>e.text())),n=[];return s=s.split("\n"),s.forEach((e=>{let t=e.split("_")[0];t.includes("-")&&(t=e.split("-")[0]);for(let a=0;a<o.length;a++){const s=o[a];if(t===s.id){n.push({id:e,abbr:s.id,iso:s.iso,ln:s.ln,tt:s.tt,tv:s.tv,ci:s.ci,cn:s.cn,tp:"hark"});break}}})),"all"!==e&&(n=n.filter((t=>t.ci===e))),"all"!==t&&(n=n.filter((e=>e.id.includes(t)))),n}())),o.providers.includes("dbp")&&(o.bibles=o.bibles.concat(await dbpList())),this.bibles=o.bibles,o.container.innerHTML="";const s=r("div",{id:`${o.idPrefix}-player-container`,className:o.class.playerContainer});r("div",{className:o.class.playerHeader});const n=o.bibleListContainer=r("div",{id:`${o.idPrefix}-bible-list-container`,className:o.class.bibleListContainer}),i=o.bookListContainer=r("div",{id:`${o.idPrefix}-book-list-container`,className:o.class.bookListContainer}),l=o.chapterListContainer=r("div",{id:`${o.idPrefix}-chapter-list-container`,className:o.class.chapterListContainer});o.bibleBlock=r("div",{id:`${o.idPrefix}-bible-block`,className:o.class.bibleBlock});const c=function(e){const t=r("div",{id:"media-player-wrap",className:e.class.mediaPlayerWrap}),o=f(e);return t.appendChild(o),t}(o);o.player=c,s.appendChild(o.bibleBlock),s.appendChild(o.audio),s.appendChild(o.player),function(e){const t=r("input",{type:"search",placeholder:e.i18n?.filter_books??"Filter Books",className:e.class.searchInput,ariaLabel:"search",autocomplete:"off",oninput:()=>{e.query=t.value,console.log(t.value,e.currentBooks.data),e.resultsBooks=u(e.query,e.currentBooks.data,["name"]),x(e)}}),o=r("div",{className:e.class.searchInputContainer});o.appendChild(t),e.bookListContainer.appendChild(o),e.bookListContainer.appendChild(e.bookListGrid=r("div",{className:e.class.bookListGrid})),x(e)}(o),s.appendChild(i),s.appendChild(l),o.container.appendChild(s),s.appendChild(n);const d=new URL(window.location);return d.searchParams.get("bibleId")&&(await h(o,this.bibles.find((e=>e.id==d.searchParams.get("bibleId")))),o.view="book"),d.searchParams.get("bookId")&&(await k(o,d.searchParams.get("bookId")),o.view="chapter"),"bible"===o.view?(p(o),c.style.display="none",n.style.display="block",i.style.display="none",l.style.display="none"):"book"===o.view?(c.style.display="block",n.style.display="none",l.style.display="none",i.style.display="block"):"chapter"===o.view&&(c.style.display="block",n.style.display="none",l.style.display="block",i.style.display="none"),o}render(){"bible"===this.view?(p(this),this.bibleListContainer.style.display="block",this.bookListContainer.style.display="none",this.chapterListContainer.style.display="none",this.player&&!this.currentChapter&&(this.player.style.display="none")):"book"===this.view?(this.bibleListContainer.style.display="none",this.chapterListContainer.style.display="none",this.bookListContainer.style.display="block",x(this),this.player&&(this.player.style.display="block")):"chapter"===this.view&&(this.bibleListContainer.style.display="none",this.chapterListContainer.style.display="block",this.bookListContainer.style.display="none",chapterList(this),this.player&&(this.player.style.display="block"))}setData(e){Object.assign(this,e)}}export{y as default};
//# sourceMappingURL=AudioPlayer.min.js.map
